<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Stash</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://kit.fontawesome.com/c45f8edf9d.js" crossorigin="anonymous"></script>
	<style>
		.btn-discord {
			background-color: #5865F2; /*Blurple*/
			color: white;
			font-weight: 500;
			border: none;
		}

		.btn-discord:hover {
			background-color: #4752c4; 
			color: white;
		}

		.thumbnail-container {
			width: 150px;
		}

		.action-button-cell {
			transition: background-color .2s ease-in-out, color .2s ease-in-out;
		}

		.action-button-cell:hover {
			background-color: rgba(255, 255, 255, 0.1);
			color: #fff;
		}

		.action-button-cell a {
			display: flex;
			width: 100%;
			height: 100%;
			align-items: center;
			justify-content: center;
			color: inherit;
		}
	</style>
</head>
<body class="d-flex flex-column min-vh-100" data-bs-theme="dark">
	<nav class="navbar navbar-expand-sm border-bottom">
		<div class="container-fluid">
			<ul class="navbar-nav me-auto">
				<li class="nav-item">
					<a class="nav-link active" href="{% url 'file_list' %}">Stash</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="{% url 'file_create' %}">Upload</a>
				</li>
			</ul>
			{% load socialaccount %} 
			{% load static %}
			{% if user.is_authenticated %}
				<span class="nav-link text-white me-2">
					Logged in as <strong>{{ user.username }}</strong>
				</span>
				<a href="{% url 'account_logout' %}" class="btn btn-outline-light">
					Logout
				</a>
			{% else %}
				<a href="{% provider_login_url 'discord' %}" class="btn btn-discord">
					Login with Discord
				</a>
			{% endif %}
		</div>
	</nav>
	
	<div class="container-xxl flex-grow-1 pt-5">
	{% for file in object_list %}
		<div class="card mb-2 {% if file.nsfw %}border-danger{% else %}border-secondary{% endif %} overflow-hidden">
			<div class="row g-0 h-100" style="min-height: 150px">
				<a href="view/{{ file.id }}" class="col-10 d-flex text-decoration-none text-reset action-button-cell">
					<div class="thumbnail-container d-flex align-items-center justify-content-center">
						{% load thumbnail %}
						{% if file.file_type == "visual" %}
							<img src="{% thumbnail file.file 'preview' %}" class="img-fluid">
						{% elif file.file_type == "audio" %}
							<i class="fas fa-music fa-4x"></i>
						{% elif file.file_type == "other" %}
							<i class="fas fa-file fa-4x"></i>
						{% endif %}
					</div>
					<div class="flex-grow-1">
						<div class="card-body">
							<div class="row">
								<div class="col-8">
									<h5 class="card-title">{{ file }}</h5>
									<p class="card-text text-muted small">{{ file.description }}</p>
								</div>
								<div class="col-4 text-end">
								{% if file.nsfw %}
									<span class="badge bg-danger">NSFW</span>
								{% endif %}
								</div>
							</div>
						</div>
					</div>
				</a>
				<div class="col-1 border-start d-flex justify-content-center action-button-cell">
					<a href="temp/">
						<i class="fas fa-download fa-lg"></i>
					</a>
				</div>
				<div class="col-1 border-start d-flex justify-content-center action-button-cell">
					<a href="temp/">
						<i class="fas fa-link fa-lg"></i>
					</a>
				</div>
			</div>
		</div>
	{% empty %}
		<p>No files yet.</p>
	{% endfor %}
	</div>
</body>
</html>